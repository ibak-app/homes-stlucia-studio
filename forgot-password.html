<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Forgot Password â€” homes.stlucia</title>
  <meta name="description" content="Reset your homes.stlucia password. Enter your email and we'll send you a reset link.">
  <link rel="stylesheet" href="assets/css/style.css">
  <script defer data-domain="homes.stlucia.studio" src="https://plausible.io/js/script.js"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-0GXK2QMVPZ"></script>
  <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-0GXK2QMVPZ');</script>
  <!-- Analytics: Facebook Pixel -->
  <script>!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');fbq('init','1403025764621663');fbq('track','PageView');</script>
</head>
<body>
  <a href="#main" class="skip-link">Skip to content</a>

  <main id="main" class="auth-page">
    <div class="auth-card">

      <a href="login.html" style="display:inline-flex;align-items:center;gap:6px;font-size:13px;color:var(--text-muted);margin-bottom:var(--spacing-lg);text-decoration:none;" aria-label="Back to sign in">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true"><path d="M19 12H5M12 5l-7 7 7 7"/></svg>
        Back to sign in
      </a>

      <div class="auth-card__logo">
        <span>homes.</span>stlucia
      </div>
      <p class="auth-card__sub">Reset your password</p>

      <div id="reset-sent" style="display:none;text-align:center;padding:var(--spacing-lg) 0;">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="1.5" style="margin:0 auto var(--spacing-md);" aria-hidden="true">
          <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07A19.5 19.5 0 013.07 9.5a19.79 19.79 0 01-3-8.57A2 2 0 012.02 1h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L6.09 8.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/>
        </svg>
        <h2 style="font-size:18px;margin-bottom:var(--spacing-sm);">Check your email</h2>
        <p style="font-size:14px;color:var(--text-muted);margin-bottom:var(--spacing-lg);">We sent a password reset link to <strong id="sent-email"></strong>. It expires in 1 hour.</p>
        <a href="login.html" class="btn btn--ghost btn--full">Back to sign in</a>
      </div>

      <form id="forgot-form" novalidate>
        <div class="form-group">
          <label class="form-label" for="forgot-email">Email address</label>
          <input class="form-input" type="email" id="forgot-email" name="email" autocomplete="email" placeholder="you@example.com" required>
          <p class="form-hint">We'll send a reset link to this address.</p>
          <div class="form-error" id="email-error" role="alert" aria-live="polite" style="display:none;"></div>
        </div>

        <button type="submit" class="btn btn--primary btn--full" id="forgot-btn">Send reset link</button>
      </form>

    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
  <script src="assets/js/supabase.js"></script>
  <script src="assets/js/app.js"></script>
  <script>
  (function() {
    var form = document.getElementById('forgot-form');
    var btn = document.getElementById('forgot-btn');
    var emailInput = document.getElementById('forgot-email');
    var emailError = document.getElementById('email-error');

    function clearErrors() {
      emailError.style.display = 'none';
      emailInput.style.borderColor = '';
    }

    function showFieldError(message) {
      emailError.textContent = message;
      emailError.style.display = 'block';
      emailInput.style.borderColor = 'var(--error)';
      emailInput.focus();
    }

    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      clearErrors();

      var email = emailInput.value.trim();

      if (!email) { showFieldError('Email is required.'); return; }
      if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { showFieldError('Please enter a valid email address.'); return; }

      btn.textContent = 'Sending\u2026';
      btn.classList.add('loading');
      btn.disabled = true;

      var result = await Auth.resetPassword(email);

      btn.textContent = 'Send reset link';
      btn.classList.remove('loading');
      btn.disabled = false;

      if (result.error) {
        showFieldError(result.error.message || 'Something went wrong. Please try again.');
        return;
      }

      document.getElementById('sent-email').textContent = email;
      form.style.display = 'none';
      document.getElementById('reset-sent').style.display = 'block';
    });
  })();
  </script>
</body>
</html>
